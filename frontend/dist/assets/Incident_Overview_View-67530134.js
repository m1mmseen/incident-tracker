import{u as I,_ as b,e as m,g as x,o,c as a,a as e,t as r,F as p,f as w,q as h,y,w as g,l as B,x as $,k as d,d as l}from"./index-1b3ec332.js";import{P as T}from"./PageTitleWithButton-b9a5ace2.js";import{U as A}from"./User_Footer_Menu-fd6895aa.js";const C=I(),N={name:"IncidentTable",data(){return{token:C.token,incidents:[]}},created(){this.fetchIncidents()},computed(){this.isAdmin()},methods:{isAdmin(){return localStorage.getItem("isAdmin")==="true"},async fetchIncidents(){const s={headers:{Authorization:`Bearer ${this.token}`}};try{const t=await m.get("api/incident/all",s);this.incidents=t.data}catch(t){console.error("Error occurred fetching incidents:",t)}},goToDetails(s){x.push({name:"incident-details",params:{id:s}})},async deleteIncident(s){const t={headers:{Authorization:`Bearer ${this.token}`}};try{await m.delete(`/api/incident/${s}`,t),await this.fetchIncidents(),await alert("deleted")}catch(_){console.error("Error occurred deleting incidents:",_)}},solved(){alert("Edited")}}},S=["onClick"],F={class:"card-header row justify-content-between bg-light-subtle"},P={class:"col text-start"},R={class:"col text-center"},V={class:"text-uppercase text-dark-emphasis"},D={key:0},E=e("b",null,"solved",-1),M={key:1},U=e("b",{class:"badge bg-danger-subtle text-dark-emphasis"},"open",-1),W={class:"card-body pt-1"},z={class:"card-text m-0 p-0"},j=e("p",null,"Test",-1),q={class:"btn-group float-end"},L=["onClick"];function O(s,t,_,f,u,i){return o(),a(p,null,[e("p",null,"Incidents: "+r(u.incidents.length),1),(o(!0),a(p,null,w(u.incidents,n=>(o(),a("div",{class:"card container text-start mt-2 m-3 border-1 border-dark",key:n.incidentId,onClick:c=>i.goToDetails(n.incidentId)},[e("div",F,[e("b",P,r(n.titel),1),e("b",R,[h("assigned to: "),e("span",V,r(n.username),1)]),e("span",y({class:"col text-end"},s.$attrs),[e("b",null,[n.isSolved?(o(),a("p",D,[h(" Status: "),E])):(o(),a("p",M,[h(" Status: "),U]))])],16)]),e("div",W,[e("p",z,r(n.description),1),j,e("div",q,[e("button",{class:"btn btn-outline-success",onClick:t[0]||(t[0]=g((...c)=>i.solved&&i.solved(...c),["stop"]))},"Solved"),i.isAdmin?(o(),a("button",{key:0,class:"btn btn-outline-danger",onClick:g(c=>i.deleteIncident(n.incidentId),["stop"])},"Delete",8,L)):B("",!0)])])],8,S))),128))],64)}const G=b(N,[["render",O]]),H={components:{NavigationBar:$,PageTitleWithButton:T,IncidentRow:G,User_Footer_Menu:A}},J={class:"container-sm"};function K(s,t,_,f,u,i){const n=d("NavigationBar"),c=d("PageTitleWithButton"),v=d("IncidentRow"),k=d("User_Footer_Menu");return o(),a(p,null,[l(n),l(c,{msg:"Incidents",destination:"/incidents/create",buttonText:"Report new Incident"}),e("div",J,[l(v)]),l(k)],64)}const Z=b(H,[["render",K]]);export{Z as default};
