import{u as _,_ as b,e as d,o as a,c as n,a as o,b as c,v as g,C as v,F as u,f,t as p,D as I,w,d as l,x as F}from"./index-1b3ec332.js";import{P as x}from"./PageTitleWithButton-b9a5ace2.js";import{U as C}from"./User_Footer_Menu-fd6895aa.js";import{I as S}from"./IncidentReportMenu-89ce9d58.js";const h=_(),D=h.userId,B=h.token,m={headers:{Authorization:`Bearer ${B}`}},T={name:"IncidentTable",data(){return{categories:[],severities:[],formdata:{titel:"",description:"",reportdate:new Date().toLocaleString("de-DE",{timeZone:"Europe/Berlin"}),isSolved:!1,user_id:D,category:"",severity:""}}},created(){this.getCategories(),this.getSeverities()},methods:{setCategory(t){this.category=t.target.value,console.log("severity:"+this.severity+" _ category:"+this.category)},setSeverity(t){this.severity=t.target.value,console.log("severity:"+this.severity+" _ category:"+this.category)},async getCategories(){try{await d.get("/api/incident/categories",m).then(t=>{t.status===200&&(this.categories=t.data)})}catch(t){console.log("Error fetching categories: "+t)}},async getSeverities(){try{await d.get("/api/incident/severities",m).then(t=>{t.status===200&&(this.severities=t.data)})}catch(t){console.log("Error fetching severities: "+t)}},async submitForm(){console.log(this.formdata),await d.post("/api/incident/report",this.formdata,m).then(t=>{t.status===201&&(alert("success"),this.formdata.titel="",this.formdata.description="",this.formdata.severity="",this.formdata.category="")}).catch(t=>{console.error("An error occurred ",t)})}}},V={class:"container-sm shadow mt-3 p-4 border-top border-5 border-warning"},k={class:"mb-3"},N=o("label",{for:"createIncidentFormTitel",class:"form-label"},"Titel",-1),U={class:"mb-3"},E=o("label",{for:"createIncidentFormDescription",class:"form-label"},"Description",-1),M={class:"row mb-3"},L={class:"col-8"},A=o("label",null,"Incident Categorie",-1),R=o("option",{value:"0",selected:""},"choose...",-1),z=["value"],P={class:"col-4"},W=o("label",null,"Severity Level",-1),Z=o("option",{value:"0",selected:""},"choose...",-1),j=["value"];function q(t,s,y,H,r,i){return a(),n("div",V,[o("form",{onSubmit:s[7]||(s[7]=w((...e)=>i.submitForm&&i.submitForm(...e),["prevent"]))},[o("div",k,[N,c(o("input",{type:"text",class:"form-control",id:"createIncidentFormTitel",placeholder:"Some suspicious event...","onUpdate:modelValue":s[0]||(s[0]=e=>r.formdata.titel=e)},null,512),[[g,r.formdata.titel]])]),o("div",U,[E,c(o("textarea",{class:"form-control",id:"createIncidentFormDescription",rows:"3",placeholder:"Describe the event as detailed as possible","onUpdate:modelValue":s[1]||(s[1]=e=>r.formdata.description=e)},null,512),[[g,r.formdata.description]])]),o("div",M,[o("div",L,[A,c(o("select",{class:"form-select me-3",id:"category","onUpdate:modelValue":s[2]||(s[2]=e=>r.formdata.category=e),onChange:s[3]||(s[3]=e=>i.setCategory(e))},[R,(a(!0),n(u,null,f(r.categories,e=>(a(),n("option",{value:e.categoryId},p(e.categoryName),9,z))),256))],544),[[v,r.formdata.category]])]),o("div",P,[W,c(o("select",{class:"form-select",id:"severity","onUpdate:modelValue":s[4]||(s[4]=e=>r.formdata.severity=e),onChange:s[5]||(s[5]=e=>i.setSeverity(e))},[Z,(a(!0),n(u,null,f(r.severities,(e,J)=>(a(),n("option",{value:e.severityId,class:I({"bg-danger":e.severityId===1,"bg-danger-subtle":e.severityId===2,"bg-warning":e.severityId===3,"bg-warning-subtle":e.severityId===4})},p(e.severityName),11,j))),256))],544),[[v,r.formdata.severity]])])]),o("button",{class:"btn btn-warning pe-lg-4 ps-lg-4",type:"button",onClick:s[6]||(s[6]=(...e)=>i.submitForm&&i.submitForm(...e))},"Report")],32)])}const G=b(T,[["render",q]]),Y={__name:"Incident_Report_View",setup(t){return(s,y)=>(a(),n(u,null,[l(F),l(x,{msg:"New Incident",destination:"/incidents",buttonText:"Back to List"}),l(S,{"active-tab":"basic"}),l(G),l(C)],64))}};export{Y as default};
